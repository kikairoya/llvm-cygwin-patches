From aecfbb1abebab11bd35009ac65426d864acbd25c Mon Sep 17 00:00:00 2001
From: kikairoya <kikairoya@gmail.com>
Date: Sat, 20 Sep 2025 22:42:42 +0900
Subject: [PATCH 32/38] [LIT][Cygwin] Separate system-cygwin from
 system-windows

---
 llvm/utils/lit/tests/lit.cfg           | 4 +++-
 llvm/utils/lit/tests/shtest-timeout.py | 2 +-
 llvm/utils/lit/tests/shtest-ulimit.py  | 2 +-
 3 files changed, 5 insertions(+), 3 deletions(-)

diff --git a/llvm/utils/lit/tests/lit.cfg b/llvm/utils/lit/tests/lit.cfg
index 1382f7ef4ab0..e69613be1217 100644
--- a/llvm/utils/lit/tests/lit.cfg
+++ b/llvm/utils/lit/tests/lit.cfg
@@ -119,8 +119,10 @@ else:
 # that the llvm_config defines. This means that the 'system-windows' feature
 # (and any others) need to match the names in llvm_config for consistency
 if not llvm_config:
-    if sys.platform.startswith("win") or sys.platform.startswith("cygwin"):
+    if sys.platform.startswith("win"):
         config.available_features.add("system-windows")
+    if sys.platform == "cygwin":
+        config.available_features.add("system-cygwin")
     if platform.system() == "AIX":
         config.available_features.add("system-aix")
 
diff --git a/llvm/utils/lit/tests/shtest-timeout.py b/llvm/utils/lit/tests/shtest-timeout.py
index 1576b89ea182..f1a7fc20684e 100644
--- a/llvm/utils/lit/tests/shtest-timeout.py
+++ b/llvm/utils/lit/tests/shtest-timeout.py
@@ -1,7 +1,7 @@
 # REQUIRES: lit-max-individual-test-time
 
 # llvm.org/PR33944
-# UNSUPPORTED: system-windows
+# UNSUPPORTED: system-windows, system-cygwin
 
 ###############################################################################
 # Check tests can hit timeout when set
diff --git a/llvm/utils/lit/tests/shtest-ulimit.py b/llvm/utils/lit/tests/shtest-ulimit.py
index e84327772d3a..b9249eb9e59a 100644
--- a/llvm/utils/lit/tests/shtest-ulimit.py
+++ b/llvm/utils/lit/tests/shtest-ulimit.py
@@ -3,7 +3,7 @@
 # ulimit does not work on non-POSIX platforms.
 # Solaris for some reason does not respect ulimit -n, so mark it unsupported
 # as well.
-# UNSUPPORTED: system-windows, system-solaris
+# UNSUPPORTED: system-windows, system-cygwin, system-solaris
 
 # RUN: not %{lit} -a -v %{inputs}/shtest-ulimit | FileCheck %s
 
-- 
2.51.0

