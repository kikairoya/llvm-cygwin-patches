From 30a4cdc98458d320a972394a07cf41ffd5dbdf35 Mon Sep 17 00:00:00 2001
From: kikairoya <kikairoya@gmail.com>
Date: Sun, 7 Sep 2025 20:44:33 +0900
Subject: [PATCH 04/40] pretest

---
 clang/test/CodeGenCXX/dllexport.cpp                | 1 +
 clang/test/CodeGenCXX/mingw-template-dllexport.cpp | 2 ++
 2 files changed, 3 insertions(+)

diff --git a/clang/test/CodeGenCXX/dllexport.cpp b/clang/test/CodeGenCXX/dllexport.cpp
index dfbb2762ac85c69b239d1c519415acab8495a9b5..894aea79af9fd5b7be8a464ab58f24f52bdebdab 100644
--- a/clang/test/CodeGenCXX/dllexport.cpp
+++ b/clang/test/CodeGenCXX/dllexport.cpp
@@ -1132,3 +1132,4 @@ class __declspec(dllexport) ACE_Service_Object : public ACE_Shared_Object {};
 // MSVC2015-DAG: define weak_odr dso_local dllexport {{.+}}ACE_Service_Object@@Q{{.+}}@$$Q
 // The declarations should not be exported.
 // MSVC2013-NOT: define weak_odr dso_local dllexport {{.+}}ACE_Service_Object@@Q{{.+}}@$$Q
+// PS-NOT: define weak_odr dllexport void @_ZN18ACE_Service_ObjectC1EOS_
diff --git a/clang/test/CodeGenCXX/mingw-template-dllexport.cpp b/clang/test/CodeGenCXX/mingw-template-dllexport.cpp
index de112d6da53dbca7a7e20d942d05c2e582103f2d..1e2759fbb5cc7f7ed9f62ca28b84063a6974df7e 100644
--- a/clang/test/CodeGenCXX/mingw-template-dllexport.cpp
+++ b/clang/test/CodeGenCXX/mingw-template-dllexport.cpp
@@ -10,11 +10,13 @@
 
 template <class T>
 class c {
+  c(c &&) noexcept {}
   void f() {}
 };
 
 template class __declspec(dllexport) c<int>;
 
+// CHECK-NOT: define {{.*}} dllexport {{.*}} @_ZN1cIiEC1EOS0_
 // CHECK: define {{.*}} dllexport {{.*}} @_ZN1cIiE1fEv
 
 extern template class __declspec(dllexport) c<char>;
-- 
2.51.2

