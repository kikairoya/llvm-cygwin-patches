From 3257806f8f45e2646cfe339e5981de9c78742682 Mon Sep 17 00:00:00 2001
From: kikairoya <kikairoya@gmail.com>
Date: Wed, 17 Sep 2025 18:23:48 +0900
Subject: [PATCH 06/38] [cmake][Clang][Cygwin] Set output name explicitly when
 cross-compiling to Cygwin

---
 clang/tools/driver/CMakeLists.txt | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/clang/tools/driver/CMakeLists.txt b/clang/tools/driver/CMakeLists.txt
index d9d36f7a4135..193a1b9a0668 100644
--- a/clang/tools/driver/CMakeLists.txt
+++ b/clang/tools/driver/CMakeLists.txt
@@ -66,8 +66,11 @@ clang_target_link_libraries(clang
   clangSerialization
   )
 
-if(WIN32 AND NOT CYGWIN)
+if(WIN32)
   # Prevent versioning if the buildhost is targeting for Win32.
+elseif(CYGWIN AND CMAKE_CROSSCOMPILING)
+  # When cross-compiling targeting Cygwin, CMake makes output-name like "clang.exe-22" unless name it explicitly.
+  set_target_properties(clang PROPERTIES OUTPUT_NAME "clang-${CLANG_VERSION_MAJOR}")
 else()
   set_target_properties(clang PROPERTIES VERSION ${CLANG_EXECUTABLE_VERSION})
 endif()
-- 
2.51.0

